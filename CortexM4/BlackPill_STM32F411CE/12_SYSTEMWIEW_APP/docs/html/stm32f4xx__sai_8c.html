<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SystemView Application: Periph_BlackPill/src/stm32f4xx_sai.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SystemView Application<span id="projectnumber">&#160;v1.0</span>
   </div>
   <div id="projectbrief">STM32F411CE SEGGER SystemView Real-time Analysis with OLED Display</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dae2dd89d33c4bdaad5fc543e1f98aab.html">Periph_BlackPill</a></li><li class="navelem"><a class="el" href="dir_f16dc92379e1f75ab0ddd250eb9f3ac7.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">stm32f4xx_sai.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file provides firmware functions to manage the following functionalities of the Serial Audio Interface (SAI):  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="stm32f4xx__sai_8h_source.html">stm32f4xx_sai.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stm32f4xx__rcc_8h_source.html">stm32f4xx_rcc.h</a>&quot;</code><br />
</div>
<p><a href="stm32f4xx__sai_8c_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file provides firmware functions to manage the following functionalities of the Serial Audio Interface (SAI): </p>
<dl class="section author"><dt>Author</dt><dd>MCD Application Team </dd></dl>
<dl class="section version"><dt>Version</dt><dd>V1.8.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>27-January-2022 <br  />
<ul>
<li>Initialization and Configuration</li>
<li>Data transfers functions</li>
<li>DMA transfers management</li>
<li>Interrupts and flags management</li>
</ul>
</dd></dl>
<pre class="fragment">===============================================================================
                    ##### How to use this driver #####
===============================================================================
   [..] 
   
      (#) Enable peripheral clock using the following functions 
          RCC_APB2PeriphClockCmd(RCC_APB2Periph_SAI1, ENABLE) for SAI1
 
      (#) For each SAI Block A/B enable SCK, SD, FS and MCLK GPIO clocks 
          using RCC_AHB1PeriphClockCmd() function.
 
      (#) Peripherals alternate function: 
          (++) Connect the pin to the desired peripherals' Alternate 
               Function (AF) using GPIO_PinAFConfig() function.
          (++) Configure the desired pin in alternate function by:
               GPIO_InitStruct-&gt;GPIO_Mode = GPIO_Mode_AF
          (++) Select the type, pull-up/pull-down and output speed via 
               GPIO_PuPd, GPIO_OType and GPIO_Speed members
          (++) Call GPIO_Init() function
          -@@- If an external clock source is used then the I2S CKIN pin should be 
              also configured in Alternate function Push-pull pull-up mode.
               
     (#) The SAI clock can be generated from different clock source :
         PLL I2S, PLL SAI or external clock source.
         (++) The PLL I2S is configured using the following functions RCC_PLLI2SConfig(), 
              RCC_PLLI2SCmd(ENABLE), RCC_GetFlagStatus(RCC_FLAG_PLLI2SRDY) and 
              RCC_SAIPLLI2SClkDivConfig() or;
             
         (++) The PLL SAI is configured using the following functions RCC_PLLSAIConfig(), 
              RCC_PLLSAICmd(ENABLE), RCC_GetFlagStatus(RCC_FLAG_PLLSAIRDY) and 
              RCC_SAIPLLSAIClkDivConfig()or;          
             
         (++) External clock source is configured using the function 
              RCC_I2SCLKConfig(RCC_I2S2CLKSource_Ext) and after setting correctly the 
              define constant I2S_EXTERNAL_CLOCK_VAL in the stm32f4xx_conf.h file.      
               
     (#) Each SAI Block A or B has its own clock generator to make these two blocks 
         completely independent. The Clock generator is configured using RCC_SAIBlockACLKConfig() and 
         RCC_SAIBlockBCLKConfig() functions.
                 
     (#) Each SAI Block A or B can be configured separately : 
         (++) Program the Master clock divider, Audio mode, Protocol, Data Length, Clock Strobing Edge, 
              Synchronous mode, Output drive and FIFO Thresold using SAI_Init() function.   
              In case of master mode, program the Master clock divider (MCKDIV) using 
              the following formula :  
              (+++) MCLK_x = SAI_CK_x / (MCKDIV * 2) with MCLK_x = 256 * FS
              (+++) FS = SAI_CK_x / (MCKDIV * 2) * 256
              (+++) MCKDIV = SAI_CK_x / FS * 512
        (++) Program the Frame Length, Frame active Length, FS Definition, FS Polarity, 
             FS Offset using SAI_FrameInit() function.    
        (++) Program the Slot First Bit Offset, Slot Size, Slot Number, Slot Active 
             using SAI_SlotInit() function. 
                  
     (#) Enable the NVIC and the corresponding interrupt using the function 
         SAI_ITConfig() if you need to use interrupt mode. 
 
     (#) When using the DMA mode 
         (++) Configure the DMA using DMA_Init() function
         (++) Active the needed channel Request using SAI_DMACmd() function
  
     (#) Enable the SAI using the SAI_Cmd() function.
  
     (#) Enable the DMA using the DMA_Cmd() function when using DMA mode. 
 
     (#) The SAI has some specific functions which can be useful depending 
         on the audio protocol selected.  
         (++) Enable Mute mode when the audio block is a transmitter using SAI_MuteModeCmd()
              function and configure the value transmitted during mute using SAI_MuteValueConfig().  
         (++) Detect the Mute mode when audio block is a receiver using SAI_MuteFrameCounterConfig().             
         (++) Enable the MONO mode without any data preprocessing in memory when the number
              of slot is equal to 2 using SAI_MonoModeConfig() function.
         (++) Enable data companding algorithm (U law and A law) using SAI_CompandingModeConfig().
         (++) Choose the behavior of the SD line in output when an inactive slot is sent 
              on the data line using SAI_TRIStateConfig() function.   
 [..]               
  (@)    In master TX mode: enabling the audio block immediately generates the bit clock 
         for the external slaves even if there is no data in the FIFO, However FS signal 
         generation is conditioned by the presence of data in the FIFO.
                
  (@)    In master RX mode: enabling the audio block immediately generates the bit clock 
         and FS signal for the external slaves. 
               
  (@)    It is mandatory to respect the following conditions in order to avoid bad SAI behavior: 
           (+@)  First bit Offset &lt;= (SLOT size - Data size)
           (+@)  Data size &lt;= SLOT size
           (+@)  Number of SLOT x SLOT size = Frame length
           (+@)  The number of slots should be even when bit FSDEF in the SAI_xFRCR is set.    </pre><dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<p>Copyright (c) 2016 STMicroelectronics. All rights reserved.</p>
<p>This software is licensed under terms that can be found in the LICENSE file in the root directory of this software component. If no LICENSE file comes with this software, it is provided AS-IS. </p>

<p class="definition">Definition in file <a class="el" href="stm32f4xx__sai_8c_source.html">stm32f4xx_sai.c</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
